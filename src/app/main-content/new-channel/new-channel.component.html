<div class="container">
  <app-header-mobile [isDesktop]="false"></app-header-mobile>
  <div class="mdc-card">
    <div
      class="channel-box pointer"
      [id]="itemID"
      (click)="openChannel($event, 'channel-edition')"
    >
      <h1 class="no-margin">
        <span>#</span>
        <span>{{ channel.name }}</span>
      </h1>
      <img src="./assets/img/icon/arrow_down.svg" alt=""/>
    </div>
    <div>
      <img
        class="pointer"
        (click)="toggleOverlay('overlay1')"
        src="./assets/img/icon/add_member.svg"
        alt=""
      />
    </div>
  </div>
  <div class="content">
    <div
      class="message-content"
      #messageContent
      style="overflow-y: scroll; height: 100%"
    >
      @if (this.firestore.channelMessages.length !== 0) {
        @for (channelMessage of
          this.firestore.channelMessages; track channelMessage.id) {
                    <div class="timeSeperator">
                        <img class="line" src="./assets/img/auth/line.svg" alt="" />

            <!--            @if (currentDate ==-->
            <!--            this.dateFormatService.formatDateYYYYMMDD(channelMessage.createdAt)) {-->
                          <span>Heute</span>
            <!--            } @else {-->
            <!--              <span>{{ this.dateFormatService.formatDate(channelMessage.createdAt) }}</span>-->
            <!--            }-->
                      </div>
          <app-conversation
            [channelMessage]="channelMessage" [isChannel]="true" [isThread]="false"
          ></app-conversation>
        }
      } @else {
        <div class="placeholder">
          <div class="channel-info">
            <h1 class="no-margin">
              <span>#</span>
              <span>{{ channel.name }}</span>
            </h1>
            <p>
              Du hast diesen Channel heute erstellt. Das ist der Anfang des Channels 
              <span># {{ channel.name }}</span>              
            </p>
          </div>
        </div>
      }
    </div>
  </div>

  <app-text-box [textBoxData]="textBoxData"></app-text-box>
</div>

<div id="overlay1" style="display: none" class="overlay">
  <div class="overlay-content">
    <div class="display-flex">
      <h1 class="no-margin">Mitglieder</h1>
      <img
        src="./assets/img/icon/close.svg"
        alt=""
        (click)="closeOverlay('overlay1')"
      />
    </div>
    <div class="members">
      <div *ngFor="let member of channel.member">
        <div class="profil">
          <img class="img-profil" src="{{ member.avatar }}" alt="">

          @if(user.isOnline){
            <img src="./assets/img/characters/online.svg" alt="Online" class="online-avatar">
          } @else {
            <img src="./assets/img/characters/offline.svg" alt="Offline" class="offline-avatar">
          }

          <p class="no-margin">{{ member.displayName }}</p>
        </div>

      </div>


      <div class="profil">
        <img class="height" src="./assets/img/icon/add_member.svg" alt=""/>
        <p (click)="toggleOverlay('overlay')" class="no-margin">
          Mitglied hinzuf√ºgen
        </p>
      </div>
    </div>
  </div>
</div>

<div id="overlay" style="display: none" class="overlay">
    <app-search-user></app-search-user>
</div>
